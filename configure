#!/bin/sh

config_lwt () {
    LWT_VER=$(opam config var lwt:version)
    case "${LWT_VER}" in
	2.* | 3.* | \#undefined)
	    patch $RECOVER --no-backup-if-mismatch -r - -f -p1 < patches/use-lwt_ppx.patch
	    ;;
	*)
	    echo not installed
	    return 1
	    ;;
    esac
}


case $1 in
    --distclean)
	RECOVER=-R config_lwt
	;;
    *)
	config_lwt
	;;
esac
